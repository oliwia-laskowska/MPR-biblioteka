<!doctype html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Wypo≈ºyczenia</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root{
            --bg:#f7f7fb; --card:#fff; --text:#1c1c1c; --muted:#666;
            --border:#e6e6e6; --shadow:0 6px 24px rgba(0,0,0,.06);
            --radius:14px; --danger:#b00020;
        }
        body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
        .container{max-width:1100px;margin:0 auto;padding:28px 18px 40px}
        .topbar{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;margin-bottom:16px}
        h1{margin:0;font-size:26px}
        .subtitle{margin:6px 0 0;color:var(--muted);font-size:14px}
        .card{background:var(--card);border:1px solid var(--border);box-shadow:var(--shadow);border-radius:var(--radius);padding:16px}
        .actions{display:flex;gap:10px;flex-wrap:wrap}
        .btn{display:inline-flex;align-items:center;gap:10px;text-decoration:none;border:1px solid var(--border);background:#fff;color:var(--text);
            border-radius:12px;padding:10px 12px;transition:transform .05s ease,box-shadow .15s ease,border-color .15s ease}
        .btn:hover{border-color:#cfcfcf;box-shadow:0 10px 24px rgba(0,0,0,.08);transform:translateY(-1px)}
        table{border-collapse:collapse;width:100%;margin-top:12px}
        th,td{border-bottom:1px solid var(--border);padding:12px 10px;text-align:left;vertical-align:top}
        th{font-size:12px;letter-spacing:.06em;text-transform:uppercase;color:var(--muted)}
        tr:hover td{background:#fcfcff}
        .error{color:var(--danger);margin:10px 0}
        .badge{display:inline-block;padding:5px 10px;border-radius:999px;border:1px solid var(--border);font-size:12px;color:var(--muted);background:#fff}
        .badge.active{border-color:#cfe4d0;color:#1f6b2a;background:#f3fbf4}
        .badge.done{border-color:#d8d8d8;color:#444;background:#f8f8f8}
        .danger{background:#fff;border:1px solid #f2c3c8;color:var(--danger);border-radius:12px;padding:8px 12px;cursor:pointer}
        .danger:hover{box-shadow:0 10px 24px rgba(176,0,32,.10)}
        button.primary{border:1px solid var(--border);background:#111;color:#fff;border-radius:12px;padding:8px 12px;cursor:pointer;font-weight:600}
        button.primary:hover{opacity:.95}
        .empty{padding:12px 0;color:var(--muted)}
        .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:12px;color:var(--muted)}
    </style>
</head>
<body>

<div class="container">
    <div class="topbar">
        <div>
            <h1>üì¶ Wypo≈ºyczenia</h1>
            <p class="subtitle">Lista wypo≈ºycze≈Ñ. Status zmienia siƒô po zwrocie ksiƒÖ≈ºki.</p>
        </div>
        <div class="actions">
            <a class="btn" th:href="@{/web}">‚Üê Start</a>
            <a class="btn" th:href="@{/web/loans/new}">+ Nowe wypo≈ºyczenie</a>
        </div>
    </div>

    <div class="card">
        <div class="error" th:if="${errorMessage}" th:text="${errorMessage}"></div>

        <div class="empty" th:if="${loans == null || loans.isEmpty()}">
            Brak wypo≈ºycze≈Ñ. Utw√≥rz pierwsze klikajƒÖc ‚ÄûNowe wypo≈ºyczenie‚Äù.
        </div>

        <table th:if="${loans != null && !loans.isEmpty()}">
            <thead>
            <tr>
                <th style="width:80px;">ID</th>
                <th>U≈ºytkownik</th>
                <th>KsiƒÖ≈ºka</th>
                <th style="width:140px;">Wypo≈ºyczono</th>
                <th style="width:140px;">Termin</th>
                <th style="width:140px;">Zwr√≥cono</th>
                <th style="width:120px;">Status</th>
                <th style="width:220px;">Akcje</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="l : ${loans}">
                <td th:text="${l.id}">1</td>
                <td>
                    <b th:text="${l.user.fullName}">Jan Kowalski</b><br>
                    <span class="mono" th:text="${l.user.email}">mail</span>
                </td>
                <td>
                    <b th:text="${l.book.title}">Tytu≈Ç</b><br>
                    <span class="mono" th:text="'ISBN: ' + ${l.book.isbn}">ISBN</span>
                </td>
                <td th:text="${l.loanDate}">2025-01-01</td>
                <td th:text="${l.dueDate}">2025-01-15</td>
                <td th:text="${l.returnDate != null ? l.returnDate : '-'}">-</td>

                <td>
                    <span class="badge active" th:if="${l.returnDate == null}">AKTYWNE</span>
                    <span class="badge done" th:if="${l.returnDate != null}">ZWR√ìCONE</span>
                </td>

                <td>
                    <form th:if="${l.returnDate == null}"
                          th:action="@{/web/loans/{id}/return(id=${l.id})}"
                          method="post"
                          style="display:inline;">
                        <button class="primary" type="submit">Oddaj</button>
                    </form>

                    <form th:action="@{/web/loans/{id}/delete(id=${l.id})}"
                          method="post"
                          style="display:inline;">
                        <button class="danger" type="submit" onclick="return confirm('UsunƒÖƒá wypo≈ºyczenie?')">
                            Usu≈Ñ
                        </button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

</body>
</html>
